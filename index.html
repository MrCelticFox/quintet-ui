<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Sample of websocket with golang</title>
    <script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <script>
        $(function() {
            var echo = new WebSocket("wss://demo.nilbot.net/echo");

            var $ulecho = $('#msg-list');
            echo.onmessage = function(e) {
                console.log("收到来自服务器的信息:" + event.data);
                $('<li>').text(event.data).appendTo($ulecho);
            };

            $('#sendBtn').click(function() {
                var data = $('#name').val();
                echo.send(data);
                console.log("发送给服务器:" + data);
            });

            // var inc = new WebSocket("wss://ws.nilbot.net/incoming");

            var $ulinc = $('#inmeta-list');
            var renderInputMeta = function(data) {
                console.log("JSON load success");
                $.each(data, function(key, value) {
                    $('<li>', {
                        "class": key
                    }).text(value).appendTo($ulinc);
                });
            }

            $('#testIncoming').click(function() {
                $.getJSON("testinmeta.json", renderInputMeta);
            });
        });
    </script>
</head>

<body>
    <p>
        <label>This is echo test section, the content you typed will be echo back from the server to you</label>
        <br>
        <input id="name" type="text" />
        <input type="button" id="sendBtn" value="send" />
        <ul id="msg-list"></ul>
    </p>
    <p>
        <label>This is incoming test section, the content from quintet will be rx and stored internally</label>
        <br>
        <input type="button" id="testIncoming" value="Go!" />
        <ul id="inmeta-list"></ul>
        <!-- Input meta render -->
    </p>
    <p>
        <label>This is reporting test section, the content from server will be tx and displayed on your end</label>
        <br>
        <ul id="result-list"></ul>
        <!-- result render -->
    </p>

</body>

</html>